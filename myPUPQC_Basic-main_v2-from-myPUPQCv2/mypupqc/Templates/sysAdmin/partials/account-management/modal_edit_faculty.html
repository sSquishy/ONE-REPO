<!-- Modal for Editing Faculty -->
<div class="modal fade" id="editFacultyModal" tabindex="-1" aria-labelledby="editFacultyrModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-simple modal-edit-faculty">
    <div class="modal-content p-3 p-md-5">
      <div class="modal-body py-3 py-md-0">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="text-center mb-4">
          <h3 class="mb-2">Edit Faculty Information</h3>
          <p class="pt-1">Please update the faculty details below.</p>
        </div>
        <form id="editFacultyForm" class="row g-4" onsubmit="return false">
          {% csrf_token %}
          <!-- Personal Information -->
          <div class="col-12 col-md-6">
            <div class="form-floating form-floating-outline">
              <input type="text" id="modalEditFacultyFirstName" name="modalEditFacultyFirstName" class="form-control" placeholder="John" required />
              <label for="modalEditFacultyFirstName">First Name</label>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="form-floating form-floating-outline">
              <input type="text" id="modalEditFacultyLastName" name="modalEditFacultyLastName" class="form-control" placeholder="Doe" required />
              <label for="modalEditFacultyLastName">Last Name</label>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="form-floating form-floating-outline">
              <input type="text" id="modalEditFacultyMiddleInitial" name="modalEditFacultyMiddleInitial" class="form-control" placeholder="D" />
              <label for="modalEditFacultyMiddleName">Middle Initial (Optional)</label>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="form-floating form-floating-outline">
              <input type="text" id="modalEditFacultySuffixName" name="modalEditFacultySuffixName" class="form-control" placeholder="Jr." />
              <label for="modalEditFacultySuffixName">Suffix (Optional)</label>
            </div>
          </div>

          <!-- Birth Information -->
          <div class="col-12 col-md-4">
            <div class="form-floating form-floating-outline">
              <select id="modalEditFacultyBirthMonth" name="modalEditFacultyBirthMonth" class="form-select" required>
                <option value="">Select Month</option>
                <option value="1">January</option>
                <option value="2">February</option>
                <option value="3">March</option>
                <option value="4">April</option>
                <option value="5">May</option>
                <option value="6">June</option>
                <option value="7">July</option>
                <option value="8">August</option>
                <option value="9">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
              </select>
              <label for="modalEditFacultyBirthMonth">Birth Month</label>
            </div>
          </div>
          <div class="col-12 col-md-4">
            <div class="form-floating form-floating-outline">
              <select id="modalEditFacultyBirthDay" name="modalEditFacultyBirthDay" class="form-select" required>
                <option value="">Select Day</option>
                <!-- Days will be dynamically populated -->
              </select>
              <label for="modalEditFacultyBirthDay">Birth Day</label>
            </div>
          </div>
          <div class="col-12 col-md-4">
            <div class="form-floating form-floating-outline">
              <select id="modalEditFacultyBirthYear" name="modalEditFacultyBirthYear" class="form-select" required>
                <option value="">Select Year</option>
                <!-- Years will be dynamically populated -->
              </select>
              <label for="modalEditFacultyBirthYear">Birth Year</label>
            </div>
          </div>

          <!-- Contact Information -->
          <div class="col-12 col-md-6">
            <div class="form-floating form-floating-outline">
              <input type="email" id="modalEditFacultyEmail" name="modalEditFacultyEmail" class="form-control" placeholder="example@domain.com" required />
              <label for="modalEditFacultyEmail">Personal Email</label>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="form-floating form-floating-outline">
              <input type="email" id="modalEditFacultyWebmail" name="modalEditFacultyWebmail" class="form-control" placeholder="faculty@domain.com" required />
              <label for="modalEditFacultyWebmail">PUP Webmail</label>
            </div>
          </div>

          <!-- Faculty Information -->
          <div class="col-12 col-md-6">
            <div class="form-floating form-floating-outline">
              <input type="text" id="modalEditFacultyNumber" name="modalEditFacultyNumber" class="form-control" placeholder="F123456" required />
              <label for="modalEditFacultyNumber">Employee Number</label>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="form-floating form-floating-outline">
              <select id="modalEditFacultyType" name="modalEditFacultyType" class="form-select" required>
                <option value="">Select Type</option>
                <option value="part-time">Faculty (Part-Time)</option>
                <option value="regular-without-designation">Faculty (Regular without Designation)</option>
                <option value="regular-with-designation">Faculty (Regular with Designation)</option>
                <option value="temporary">Faculty (Temporary)</option>
              </select>
              <label for="modalEditFacultyType">Faculty Type</label>
            </div>
          </div>
          <div class="col-12 col-md-12">
            <div class="form-floating form-floating-outline">
              <select id="modalEditFacultyRank" name="modalEditFacultyRank" class="form-select" required>
                <option value="">Select Rank</option>
                <option value="Instructor I">Instructor I</option>
                <option value="Instructor II">Instructor II</option>
                <option value="Instructor III">Instructor III</option>
                <option value="Assistant Professor I">Assistant Professor I</option>
                <option value="Assistant Professor II">Assistant Professor II</option>
                <option value="Assistant Professor III">Assistant Professor III</option>
                <option value="Assistant Professor IV">Assistant Professor IV</option>
                <option value="Associate Professor I">Associate Professor I</option>
                <option value="Associate Professor II">Associate Professor II</option>
                <option value="Associate Professor III">Associate Professor III</option>
                <option value="Associate Professor IV">Associate Professor IV</option>
                <option value="Associate Professor V">Associate Professor V</option>
                <option value="Professor I">Professor I</option>
                <option value="Professor II">Professor II</option>
                <option value="Professor III">Professor III</option>
                <option value="Professor IV">Professor IV</option>
                <option value="Professor V">Professor V</option>
                <option value="Professor VI">Professor VI</option>
                <option value="Professor VII">Professor VII</option>
                <option value="College/University Professor">College/University Professor - â‚±199,150.00</option>
              </select>
              <label for="modalEditFacultyRank">Academic/Administrative Rank</label>
            </div>
          </div>

          <!-- Status and Remarks -->
          {% comment %} <div class="col-12 col-md-12">
            <div class="form-floating form-floating-outline">
              <select id="modalEditFacultyStatus" name="modalEditFacultyStatus" class="form-select" required>
                <option value="">Select Status</option>
                <option value="Active">Active</option>
                <option value="Inactive">Inactive</option>
              </select>
              <label for="modalEditFacultyBirthMonth">Status</label>
            </div>
          </div> {% endcomment %}
          <div class="col-12">
            <div class="form-floating form-floating-outline">
              <textarea id="modalEditFacultyRemarks" name="modalEditFacultyRemarks" class="form-control" placeholder="Remarks"></textarea>
              <label for="modalEditFacultyRemarks">Remarks</label>
            </div>
          </div>

          <div class="col-12 text-center">
            <button type="submit" class="btn btn-primary me-sm-3 me-1" id="editSubmitButton">Update</button>
            <button type="reset" class="btn btn-outline-secondary" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  // Function to pre-fill the edit modal with existing data
  function openEditModal(data) {
    // Personal Information
    document.getElementById('modalEditFacultyFirstName').value = data.firstName;
    document.getElementById('modalEditFacultyLastName').value = data.lastName;
    document.getElementById('modalEditFacultyMiddleInitial').value = data.middleInitial;
    document.getElementById('modalEditFacultySuffixName').value = data.suffixName;

    // Birth Information
    document.getElementById('modalEditFacultyBirthMonth').value = data.birthMonth;
    document.getElementById('modalEditFacultyBirthYear').value = data.birthYear;
    populateEditDays(data.birthMonth, data.birthYear);
    setTimeout(() => { document.getElementById('modalEditFacultyBirthDay').value = data.birthDay; }, 50);

    // Contact Information
    document.getElementById('modalEditFacultyEmail').value = data.email;
    document.getElementById('modalEditFacultyWebmail').value = data.webmail;

    // Faculty Information
    document.getElementById('modalEditFacultyNumber').value = data.employeeNumber;
    document.getElementById('modalEditFacultyType').value = data.facultyType;
    document.getElementById('modalEditFacultyRank').value = data.facultyRank;

    // Status and Remarks
    document.getElementById('modalEditFacultyStatus').value = data.status;
    document.getElementById('modalEditFacultyRemarks').value = data.remarks;

    new bootstrap.Modal(document.getElementById('editFacultyModal')).show();
  }

  // Date population functions
  function populateEditDays(month, year) {
    const daySelect = document.getElementById('modalEditFacultyBirthDay');
    daySelect.innerHTML = '<option value="">Select Day</option>';

    if (month && year) {
      const daysInMonth = new Date(year, month, 0).getDate();
      for (let i = 1; i <= daysInMonth; i++) {
        daySelect.innerHTML += `<option value="${i}">${i}</option>`;
      }
    }
  }

  function populateEditYears() {
    const yearSelect = document.getElementById('modalEditFacultyBirthYear');
    const currentYear = new Date().getFullYear();

    yearSelect.innerHTML = '<option value="">Select Year</option>';
    for (let year = currentYear; year >= currentYear - 100; year--) {
      yearSelect.innerHTML += `<option value="${year}">${year}</option>`;
    }
  }

  // Form validation and submission
  document.getElementById('editSubmitButton').addEventListener('click', function () {
    const invalidFields = [...document.querySelectorAll('#editFacultyForm [required]')]
      .filter(field => !field.value.trim());

    if (invalidFields.length) {
      invalidFields.forEach(field => field.classList.add('is-invalid'));
      Swal.fire({
        title: 'Missing Information',
        text: 'Please fill in all required fields.',
        icon: 'error',
        confirmButton: 'btn btn-danger'
      });
      return;
    }

    Swal.fire({
      title: 'Update Faculty?',
      text: "Confirm to update faculty details.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonText: 'Update',
      customClass: {
        confirmButton: 'btn btn-primary me-3',
        cancelButton: 'btn btn-outline-secondary'
      }
    }).then((result) => {
      if (result.isConfirmed) {
        // Here you would typically add your AJAX submit logic
        Swal.fire({
          icon: 'success',
          title: 'Updated!',
          confirmButton: 'btn btn-success'
        }).then(() => {
          bootstrap.Modal.getInstance(document.getElementById('editFacultyModal')).hide();
        });
      }
    });
  });

  // Initialize date inputs
  document.addEventListener('DOMContentLoaded', () => {
    populateEditYears();

    const updateDays = () => populateEditDays(
      document.getElementById('modalEditFacultyBirthMonth').value,
      document.getElementById('modalEditFacultyBirthYear').value
    );

    document.getElementById('modalEditFacultyBirthMonth').addEventListener('change', updateDays);
    document.getElementById('modalEditFacultyBirthYear').addEventListener('change', updateDays);
  });
</script>

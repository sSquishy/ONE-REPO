<!-- Modal for Bulk Upload -->
<div class="modal fade" id="bulkUploadModal" tabindex="-1" aria-labelledby="bulkUploadModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl" style="max-width: 1200px;"> <!-- Increased width -->
    <div class="modal-content p-3 p-md-5">
      <div class="modal-body py-3 py-md-0">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="text-center mb-4">
          <h3 class="mb-2">Bulk Upload Information</h3>
          <p class="pt-1">Upload CSV/Excel file containing multiple personnel records</p>
        </div>

        <!-- Upload Section -->
        <div class="col-12">
          <div class="card mb-4">
            <h5 class="card-header">Upload File</h5>
            <div class="card-body">
              <form action="/upload" class="dropzone needsclick" id="dropzone-basic">
                <div class="dz-message needsclick">
                  Drop files here or click to upload
                  <span class="note needsclick">(Supported formats: .csv, .xlsx, .xls | Max size: 5MB)</span>
                </div>
                <div class="fallback">
                  <input name="file" type="file" />
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Preview Section -->
        <div class="col-12 preview-section d-none">
          <div class="card">
            <h5 class="card-header">Preview</h5>
            <div class="card-body p-2">
              <div class="table-responsive" style="max-height: 500px; font-size: 0.875rem;">
                <table class="table table-bordered table-sm" id="previewTable" style="font-size: inherit; min-width: 800px;">
                  <thead class="small bg-light"></thead>
                  <tbody></tbody>
                </table>
              </div>
              <!-- Modal Footer with Conditional Upload Button -->
              <div class="modal-footer d-flex justify-content-center pt-4">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="confirmUpload" style="display: none;">
                  <i class="mdi mdi-upload me-1"></i> Upload File
                </button>
              </div>

            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<style>
  /* Custom adjustments */
  .table-responsive {
    overflow-x: auto;
    overflow-y: auto;
  }

  #previewTable {
    min-width: 100%;
    white-space: nowrap;
  }

  #previewTable th {
    position: sticky;
    top: 0;
    background: #f8f9fa;
    z-index: 1;
  }

  #previewTable td.empty-cell {
    background-color: #fff9f9;
    color: #dc3545;
    font-style: italic;
    white-space: nowrap;
  }

  #previewTable td, #previewTable th {
    min-width: 150px;
    max-width: 300px;
    overflow: hidden;
    text-overflow: ellipsis;
  }
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
